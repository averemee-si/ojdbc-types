/**
 * Copyright (c) 2018-present, A2 Re≈°itve d.o.o.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in
 * compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License is
 * distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See
 * the License for the specific language governing permissions and limitations under the License.
 */
package solutions.a2.oracle.utils;

import static org.junit.jupiter.api.Assertions.assertEquals;

import java.nio.charset.StandardCharsets;

import org.junit.jupiter.api.Test;

/**
 *  
 * @author <a href="mailto:averemee@a2.solutions">Aleksei Veremeev</a>
 * 
 */
public class BinaryUtilsTest {


	@Test
	public void test() {
		final String pattern = "HEXTORAW(";
		final byte[] baPattern = pattern.getBytes(StandardCharsets.US_ASCII);

		final String sqlRedoInsert1 = "insert into \"UNKNOWN\".\"OBJ# 174162\"(\"COL 1\",\"COL 2\",\"COL 3\",\"COL 4\",\"COL 5\",\"COL 6\",\"COL 7\",\"COL 8\",\"COL 9\",\"COL 10\",\"COL 11\",\"COL 12\",\"COL 13\",\"COL 14\",\"COL 15\",\"COL 16\",\"COL 17\",\"COL 18\",\"COL 19\",\"COL 20\",\"COL 21\",\"COL 22\",\"COL 23\",\"COL 24\",\"COL 25\",\"COL 26\",\"COL 27\",\"COL 28\",\"COL 29\",\"COL 30\",\"COL 31\",\"COL 32\",\"COL 33\",\"COL 34\",\"COL 35\",\"COL 36\",\"COL 37\",\"COL 38\",\"COL 39\",\"COL 40\",\"COL 41\",\"COL 42\",\"COL 43\",\"COL 44\",\"COL 45\",\"COL 46\",\"COL 47\",\"COL 48\",\"COL 49\",\"COL 50\",\"COL 51\",\"COL 52\",\"COL 53\",\"COL 54\",\"COL 55\",\"COL 56\",\"COL 57\",\"COL 58\",\"COL 59\",\"COL 60\",\"COL 61\",\"COL 62\",\"COL 63\",\"COL 64\",\"COL 65\",\"COL 66\",\"COL 67\",\"COL 68\",\"COL 69\",\"COL 70\",\"COL 71\",\"COL 72\",\"COL 73\",\"COL 74\",\"COL 75\",\"COL 76\",\"COL 77\",\"COL 78\",\"COL 79\",\"COL 80\",\"COL 81\",\"COL 82\",\"COL 83\",\"COL 84\",\"COL 85\",\"COL 86\",\"COL 87\",\"COL 88\",\"COL 89\",\"COL 90\",\"COL 91\",\"COL 92\",\"COL 93\",\"COL 94\",\"COL 95\",\"COL 96\",\"COL 97\",\"COL 98\",\"COL 99\",\"COL 100\",\"COL 101\",\"COL 102\",\"COL 103\",\"COL 104\",\"COL 105\",\"COL 106\",\"COL 107\",\"COL 108\",\"COL 109\",\"COL 110\",\"COL 111\",\"COL 112\",\"COL 113\",\"COL 114\",\"COL 115\",\"COL 116\",\"COL 117\",\"COL 118\",\"COL 119\",\"COL 120\",\"COL 121\",\"COL 122\",\"COL 123\",\"COL 124\",\"COL 125\",\"COL 126\",\"COL 127\",\"COL 128\",\"COL 129\",\"COL 130\",\"COL 131\",\"COL 132\",\"COL 133\",\"COL 134\",\"COL 135\",\"COL 136\",\"COL 137\",\"COL 138\",\"COL 139\",\"COL 140\",\"COL 141\",\"COL 142\",\"COL 143\",\"COL 144\",\"COL 145\",\"COL 146\",\"COL 147\",\"COL 148\",\"COL 149\",\"COL 150\",\"COL 151\",\"COL 152\",\"COL 153\",\"COL 154\",\"COL 155\",\"COL 156\",\"COL 157\",\"COL 158\",\"COL 159\",\"COL 160\",\"COL 161\",\"COL 162\",\"COL 163\",\"COL 164\",\"COL 165\",\"COL 166\",\"COL 167\",\"COL 168\",\"COL 169\",\"COL 170\",\"COL 171\",\"COL 172\",\"COL 173\",\"COL 174\",\"COL 175\",\"COL 176\",\"COL 177\",\"COL 178\",\"COL 179\",\"COL 180\",\"COL 181\",\"COL 182\",\"COL 183\",\"COL 184\",\"COL 185\",\"COL 186\",\"COL 187\",\"COL 188\",\"COL 189\",\"COL 190\",\"COL 191\",\"COL 192\",\"COL 193\",\"COL 194\",\"COL 195\",\"COL 196\",\"COL 197\",\"COL 198\",\"COL 199\",\"COL 200\",\"COL 201\",\"COL 202\",\"COL 203\",\"COL 204\",\"COL 205\",\"COL 206\",\"COL 207\",\"COL 208\",\"COL 209\",\"COL 210\",\"COL 211\",\"COL 212\",\"COL 213\",\"COL 214\",\"COL 215\",\"COL 216\",\"COL 217\",\"COL 218\",\"COL 219\",\"COL 220\",\"COL 221\",\"COL 222\",\"COL 223\",\"COL 224\",\"COL 225\",\"COL 226\",\"COL 227\",\"COL 228\",\"COL 229\",\"COL 230\",\"COL 231\",\"COL 232\",\"COL 233\",\"COL 234\",\"COL 235\",\"COL 236\",\"COL 237\",\"COL 238\",\"COL 239\",\"COL 240\",\"COL 241\",\"COL 242\",\"COL 243\",\"COL 244\",\"COL 245\",\"COL 246\",\"COL 247\",\"COL 248\",\"COL 249\",\"COL 250\",\"COL 251\",\"COL 252\",\"COL 253\",\"COL 254\",\"COL 255\",\"COL 256\",\"COL 257\",\"COL 258\",\"COL 259\",\"COL 260\",\"COL 261\",\"COL 262\",\"COL 263\",\"COL 264\",\"COL 265\",\"COL 266\",\"COL 267\",\"COL 268\",\"COL 269\",\"COL 270\",\"COL 271\",\"COL 272\",\"COL 273\",\"COL 274\",\"COL 275\",\"COL 276\",\"COL 277\",\"COL 278\",\"COL 279\",\"COL 280\",\"COL 281\",\"COL 282\",\"COL 283\",\"COL 284\",\"COL 285\",\"COL 286\",\"COL 287\",\"COL 288\",\"COL 289\",\"COL 290\",\"COL 291\",\"COL 292\",\"COL 293\",\"COL 294\",\"COL 295\",\"COL 296\",\"COL 297\",\"COL 298\",\"COL 299\",\"COL 300\",\"COL 301\",\"COL 302\",\"COL 303\",\"COL 304\",\"COL 305\",\"COL 306\",\"COL 307\",\"COL 308\",\"COL 309\",\"COL 310\",\"COL 311\",\"COL 312\",\"COL 313\",\"COL 314\",\"COL 315\",\"COL 316\",\"COL 317\",\"COL 318\",\"COL 319\",\"COL 320\",\"COL 321\",\"COL 322\",\"COL 323\",\"COL 324\",\"COL 325\",\"COL 326\",\"COL 327\",\"COL 328\",\"COL 329\",\"COL 330\",\"COL 331\",\"COL 332\",\"COL 333\",\"COL 334\",\"COL 335\",\"COL 336\",\"COL 337\",\"COL 338\",\"COL 339\",\"COL 340\",\"COL 341\",\"COL 342\",\"COL 343\",\"COL 344\",\"COL 345\",\"COL 346\",\"COL 347\",\"COL 348\",\"COL 349\",\"COL 350\",\"COL 351\",\"COL 352\",\"COL 353\",\"COL 354\",\"COL 355\",\"COL 356\",\"COL 357\",\"COL 358\",\"COL 359\",\"COL 360\",\"COL 361\",\"COL 362\",\"COL 363\",\"COL 364\",\"COL 365\",\"COL 366\",\"COL 367\",\"COL 368\",\"COL 369\",\"COL 370\",\"COL 371\",\"COL 372\",\"COL 373\",\"COL 374\",\"COL 375\") values (HEXTORAW('c416311357'),HEXTORAW('c154'),HEXTORAW('c40d1c2312'),HEXTORAW('c20b02'),HEXTORAW('c102'),HEXTORAW('787c0b19010101'),HEXTORAW('787c0b19010101'),HEXTORAW('787c0b0b183c01'),HEXTORAW('4341'),HEXTORAW('c2022d'),HEXTORAW('4541'),HEXTORAW('80'),NULL,HEXTORAW('c107'),NULL,NULL,NULL,HEXTORAW('80'),HEXTORAW('53'),NULL,NULL,HEXTORAW('c2033e'),HEXTORAW('c32a3b18'),HEXTORAW('c24222'),NULL,NULL,NULL,NULL,HEXTORAW('c154'),HEXTORAW('c3072b1f'),HEXTORAW('38323236363834'),HEXTORAW('80'),HEXTORAW('80'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,HEXTORAW('c4055c1504'),HEXTORAW('787c0b0b120101'),NULL,NULL,NULL,HEXTORAW('c23d06'),HEXTORAW('787c081a0d0315'),HEXTORAW('c103'),NULL,NULL,HEXTORAW('3030303030315f464544204558204752445f505f5354414e44415244'),HEXTORAW('464544204558204752442050415243454c'),HEXTORAW('50616964'),HEXTORAW('435553544f4d45522053495445'),NULL,HEXTORAW('c20b07'),HEXTORAW('3e6366'),NULL,NULL,HEXTORAW('38323236363834'),NULL,HEXTORAW('4f455f4f524445525f4c494e45535f414c4c3231343831383836'),NULL,NULL,NULL,NULL,NULL,HEXTORAW('c2026151'),HEXTORAW('c2026151'),HEXTORAW('80'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,HEXTORAW('787c0b0c071c29'),HEXTORAW('c3021516'),HEXTORAW('787c0b0c071c2a'),HEXTORAW('c3021516'),HEXTORAW('c502222c373e'),HEXTORAW('c2073d'),HEXTORAW('c3045f2b'),HEXTORAW('787c081a0d0315'),HEXTORAW('c5021d36160b'),NULL,NULL,NULL,NULL,NULL,NULL,HEXTORAW('5354414e44415244'),NULL,HEXTORAW('4e'),HEXTORAW('4e'),HEXTORAW('59'),HEXTORAW('4f52444552'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,HEXTORAW('787d0b19010101'),NULL,HEXTORAW('787c0b0b183c01'),NULL,HEXTORAW('5343484544554c4544'),HEXTORAW('494e5445524e414c'),NULL,HEXTORAW('59'),HEXTORAW('4e'),HEXTORAW('59'),NULL,NULL,HEXTORAW('3e6266'),NULL,NULL,NULL,NULL,NULL,HEXTORAW('43414e43454c4c4154494f4e'),HEXTORAW('787c0b0c071c2c'),HEXTORAW('c3021516'),NULL,NULL,HEXTORAW('c415513229'),NULL,NULL,HEXTORAW('43555354'),NULL,NULL,NULL,HEXTORAW('59'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,HEXTORAW('32323132363738'),HEXTORAW('c403022c16'),NULL,NULL,NULL,NULL,HEXTORAW('4e'),HEXTORAW('4157414954494e475f5348495050494e47'),NULL,NULL,HEXTORAW('59'),HEXTORAW('c107'),HEXTORAW('323032343038323620313230313134202b2e31'),NULL,NULL,HEXTORAW('31'),NULL,HEXTORAW('c2026151'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,HEXTORAW('80'),NULL,NULL,NULL,NULL,HEXTORAW('4e'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,HEXTORAW('53595354454d'),HEXTORAW('c40b4e180c'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,HEXTORAW('c306114b'),NULL,NULL,HEXTORAW('c107'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,HEXTORAW('80'),NULL,HEXTORAW('46'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,HEXTORAW('59'),NULL,NULL,HEXTORAW('c40f19211c'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,HEXTORAW('4e'))";
		final byte[] baInsert1 = sqlRedoInsert1.getBytes(StandardCharsets.US_ASCII);

		assertEquals(
				sqlRedoInsert1.indexOf('('),
				BinaryUtils.indexOf(baInsert1, (byte)0x28)
		);
		assertEquals(
				sqlRedoInsert1.indexOf(')'),
				BinaryUtils.indexOf(baInsert1, (byte)0x29)
		);
		assertEquals(
				sqlRedoInsert1.indexOf(pattern),
				BinaryUtils.indexOf(baInsert1, baPattern)
		);
		assertEquals(
				new String(squeeze(baInsert1, baPattern, (byte)0x29), StandardCharsets.US_ASCII),
				sqlRedoInsert1.replace(pattern, "").replace("')", "'")
		);
		System.out.println();
		System.out.println(sqlRedoInsert1);
		System.out.println(new String(squeeze(baInsert1, baPattern, (byte)0x29), StandardCharsets.US_ASCII));
		System.out.println(sqlRedoInsert1.replace(pattern, "").replace("')", "'"));

		final String sqlRedoInsert2 = "insert into \"UNKNOWN\".\"OBJ# 0\"(\"COL 1\",\"COL 2\") values(NULL, NULL)";
		final byte[] baInsert2 = sqlRedoInsert2.getBytes(StandardCharsets.US_ASCII);
		assertEquals(
				new String(squeeze(baInsert2, baPattern, (byte)0x29), StandardCharsets.US_ASCII),
				sqlRedoInsert2.replace(pattern, "").replace("')", "'")
		);
		System.out.println();
		System.out.println(sqlRedoInsert2);
		System.out.println(new String(squeeze(baInsert2, baPattern, (byte)0x29), StandardCharsets.US_ASCII));
		System.out.println(sqlRedoInsert2.replace(pattern, "").replace("')", "'"));

		final String[] sqlRedoUpdateArray = {
				"update \"UNKNOWN\".\"OBJ# 174043\" set \"COL 3\" = HEXTORAW('c40d170e5c'), \"COL 4\" = HEXTORAW('c20b02'), \"COL 5\" = HEXTORAW('c102'), \"COL 6\" = HEXTORAW('31343538383139'), \"COL 7\" = HEXTORAW('787c081b010101'), \"COL 8\" = HEXTORAW('787c081b010101'), \"COL 9\" = NULL, \"COL 10\" = HEXTORAW('4541'), \"COL 11\" = HEXTORAW('c155'), \"COL 12\" = HEXTORAW('4541'), \"COL 13\" = HEXTORAW('80'), \"COL 14\" = NULL, \"COL 15\" = HEXTORAW('c155'), \"COL 16\" = NULL, \"COL 17\" = NULL, \"COL 18\" = NULL, \"COL 19\" = NULL, \"COL 20\" = HEXTORAW('53'), \"COL 21\" = NULL, \"COL 22\" = NULL, \"COL 23\" = HEXTORAW('c2033e'), \"COL 24\" = HEXTORAW('c24504'), \"COL 25\" = HEXTORAW('c24105'), \"COL 26\" = NULL, \"COL 27\" = NULL, \"COL 28\" = NULL, \"COL 29\" = NULL, \"COL 30\" = NULL, \"COL 31\" = NULL, \"COL 32\" = HEXTORAW('c154'), \"COL 33\" = HEXTORAW('c3072a1a'), \"COL 34\" = HEXTORAW('38313230363734393734'), \"COL 35\" = HEXTORAW('80'), \"COL 36\" = HEXTORAW('80'), \"COL 37\" = NULL, \"COL 38\" = NULL, \"COL 39\" = NULL, \"COL 40\" = NULL, \"COL 41\" = NULL, \"COL 42\" = NULL, \"COL 43\" = NULL, \"COL 44\" = NULL, \"COL 45\" = NULL, \"COL 46\" = HEXTORAW('c4020e5355'), \"COL 47\" = HEXTORAW('787c081b010101'), \"COL 48\" = NULL, \"COL 49\" = NULL, \"COL 50\" = NULL, \"COL 51\" = NULL, \"COL 52\" = HEXTORAW('c32f134a'), \"COL 53\" = HEXTORAW('787c0814011f22'), \"COL 54\" = HEXTORAW('c102'), \"COL 55\" = NULL, \"COL 56\" = NULL, \"COL 57\" = HEXTORAW('3030303030315f554e53504543494649455f4c5f5354414e44415244'), \"COL 58\" = HEXTORAW('554e535045434946494544'), \"COL 59\" = HEXTORAW('50616964'), \"COL 60\" = HEXTORAW('435553544f4d45522053495445'), \"COL 61\" = NULL, \"COL 62\" = HEXTORAW('c3022c02'), \"COL 63\" = HEXTORAW('3e6366'), \"COL 64\" = NULL, \"COL 65\" = NULL, \"COL 66\" = HEXTORAW('38313230363734393734'), \"COL 67\" = NULL, \"COL 68\" = HEXTORAW('31'), \"COL 69\" = NULL, \"COL 70\" = NULL, \"COL 71\" = NULL, \"COL 72\" = NULL, \"COL 73\" = NULL, \"COL 74\" = NULL, \"COL 75\" = NULL, \"COL 76\" = NULL, \"COL 77\" = NULL, \"COL 78\" = NULL, \"COL 79\" = NULL, \"COL 80\" = NULL, \"COL 81\" = NULL, \"COL 82\" = NULL, \"COL 83\" = NULL, \"COL 84\" = NULL, \"COL 85\" = NULL, \"COL 86\" = NULL, \"COL 87\" = NULL, \"COL 88\" = NULL, \"COL 89\" = NULL, \"COL 90\" = NULL, \"COL 91\" = NULL, \"COL 92\" = NULL, \"COL 93\" = NULL, \"COL 94\" = NULL, \"COL 95\" = NULL, \"COL 96\" = NULL, \"COL 97\" = NULL, \"COL 98\" = NULL, \"COL 99\" = NULL, \"COL 100\" = NULL, \"COL 101\" = NULL, \"COL 102\" = NULL, \"COL 103\" = NULL, \"COL 104\" = NULL, \"COL 105\" = NULL, \"COL 106\" = NULL, \"COL 107\" = NULL, \"COL 108\" = NULL, \"COL 109\" = NULL, \"COL 110\" = NULL, \"COL 111\" = NULL, \"COL 112\" = NULL, \"COL 113\" = NULL, \"COL 114\" = NULL, \"COL 115\" = NULL, \"COL 116\" = NULL, \"COL 117\" = NULL, \"COL 118\" = NULL, \"COL 119\" = NULL, \"COL 120\" = NULL, \"COL 121\" = NULL, \"COL 122\" = NULL, \"COL 123\" = NULL, \"COL 124\" = NULL, \"COL 125\" = NULL, \"COL 126\" = NULL, \"COL 127\" = NULL, \"COL 128\" = NULL, \"COL 129\" = NULL, \"COL 130\" = NULL, \"COL 131\" = NULL, \"COL 132\" = NULL, \"COL 133\" = NULL, \"COL 134\" = NULL, \"COL 135\" = NULL, \"COL 136\" = NULL, \"COL 137\" = NULL, \"COL 138\" = NULL, \"COL 139\" = NULL, \"COL 140\" = NULL, \"COL 141\" = NULL, \"COL 142\" = NULL, \"COL 143\" = NULL, \"COL 144\" = NULL, \"COL 145\" = NULL, \"COL 146\" = NULL, \"COL 147\" = NULL, \"COL 148\" = NULL, \"COL 149\" = NULL, \"COL 150\" = NULL, \"COL 151\" = NULL, \"COL 152\" = NULL, \"COL 153\" = NULL, \"COL 154\" = NULL, \"COL 155\" = NULL, \"COL 156\" = HEXTORAW('787c0814011f23'), \"COL 157\" = HEXTORAW('80'), \"COL 158\" = HEXTORAW('787c0814011f28'), \"COL 159\" = HEXTORAW('80'), \"COL 160\" = HEXTORAW('c5021f1d551c'), \"COL 161\" = HEXTORAW('c2073d'), \"COL 162\" = HEXTORAW('c3045f2b'), \"COL 163\" = HEXTORAW('787c0814011f1d'), \"COL 164\" = HEXTORAW('c5021d1e054c'), \"COL 165\" = NULL, \"COL 166\" = NULL, \"COL 167\" = NULL, \"COL 168\" = NULL, \"COL 169\" = NULL, \"COL 170\" = NULL, \"COL 171\" = HEXTORAW('5354414e44415244'), \"COL 172\" = NULL, \"COL 173\" = HEXTORAW('4e'), \"COL 174\" = HEXTORAW('4e'), \"COL 175\" = NULL, \"COL 176\" = HEXTORAW('4f52444552'), \"COL 177\" = NULL, \"COL 178\" = NULL, \"COL 179\" = NULL, \"COL 180\" = NULL, \"COL 181\" = NULL, \"COL 182\" = NULL, \"COL 183\" = N",
				"ULL, \"COL 184\" = NULL, \"COL 185\" = NULL, \"COL 186\" = NULL, \"COL 187\" = NULL, \"COL 188\" = NULL, \"COL 189\" = NULL, \"COL 190\" = NULL, \"COL 191\" = NULL, \"COL 192\" = NULL, \"COL 193\" = NULL, \"COL 194\" = NULL, \"COL 195\" = NULL, \"COL 196\" = NULL, \"COL 197\" = NULL, \"COL 199\" = NULL, \"COL 200\" = NULL, \"COL 201\" = HEXTORAW('787d081b010101'), \"COL 202\" = NULL, \"COL 203\" = NULL, \"COL 204\" = NULL, \"COL 205\" = NULL, \"COL 206\" = HEXTORAW('494e5445524e414c'), \"COL 207\" = HEXTORAW('4e'), \"COL 208\" = HEXTORAW('59'), \"COL 209\" = HEXTORAW('4e'), \"COL 210\" = HEXTORAW('3e6266'), \"COL 211\" = NULL, \"COL 212\" = NULL, \"COL 213\" = NULL, \"COL 214\" = NULL, \"COL 215\" = NULL, \"COL 216\" = NULL, \"COL 217\" = NULL, \"COL 218\" = NULL, \"COL 219\" = HEXTORAW('c3280e23'), \"COL 220\" = HEXTORAW('43555354'), \"COL 221\" = NULL, \"COL 222\" = NULL, \"COL 223\" = HEXTORAW('4e'), \"COL 224\" = NULL, \"COL 225\" = NULL, \"COL 226\" = NULL, \"COL 227\" = NULL, \"COL 228\" = NULL, \"COL 229\" = NULL, \"COL 230\" = HEXTORAW('c107'), \"COL 231\" = HEXTORAW('323032343038323020303033303037202b2e31'), \"COL 232\" = NULL, \"COL 234\" = HEXTORAW('31'), \"COL 235\" = NULL, \"COL 236\" = HEXTORAW('c057'), \"COL 237\" = NULL, \"COL 238\" = NULL, \"COL 239\" = NULL, \"COL 240\" = NULL, \"COL 241\" = NULL, \"COL 243\" = NULL, \"COL 244\" = NULL, \"COL 245\" = NULL, \"COL 246\" = NULL, \"COL 247\" = NULL, \"COL 248\" = NULL, \"COL 249\" = NULL, \"COL 250\" = NULL, \"COL 251\" = NULL, \"COL 252\" = NULL, \"COL 253\" = NULL, \"COL 254\" = NULL, \"COL 255\" = NULL, \"COL 256\" = NULL, \"COL 257\" = NULL, \"COL 258\" = NULL, \"COL 259\" = NULL, \"COL 260\" = HEXTORAW('59'), \"COL 261\" = NULL, \"COL 262\" = HEXTORAW('4e'), \"COL 263\" = HEXTORAW('454e5445524544'), \"COL 264\" = NULL, \"COL 265\" = NULL, \"COL 266\" = NULL, \"COL 267\" = NULL, \"COL 268\" = NULL, \"COL 269\" = NULL, \"COL 270\" = NULL, \"COL 271\" = NULL, \"COL 272\" = NULL, \"COL 273\" = NULL, \"COL 274\" = NULL, \"COL 275\" = NULL, \"COL 276\" = NULL, \"COL 277\" = NULL, \"COL 278\" = NULL, \"COL 279\" = NULL, \"COL 280\" = NULL, \"COL 281\" = NULL, \"COL 282\" = NULL, \"COL 283\" = NULL, \"COL 284\" = NULL, \"COL 285\" = HEXTORAW('59'), \"COL 288\" = NULL, \"COL 289\" = NULL, \"COL 290\" = NULL, \"COL 291\" = NULL, \"COL 292\" = NULL, \"COL 293\" = NULL, \"COL 294\" = NULL, \"COL 295\" = NULL, \"COL 296\" = NULL, \"COL 297\" = NULL, \"COL 298\" = HEXTORAW('c103'), \"COL 299\" = NULL, \"COL 300\" = NULL, \"COL 301\" = NULL, \"COL 302\" = NULL, \"COL 303\" = NULL, \"COL 304\" = NULL, \"COL 305\" = NULL, \"COL 306\" = NULL, \"COL 307\" = NULL, \"COL 308\" = NULL, \"COL 309\" = NULL, \"COL 310\" = NULL, \"COL 311\" = NULL, \"COL 312\" = NULL, \"COL 313\" = NULL, \"COL 314\" = NULL, \"COL 315\" = NULL, \"COL 316\" = NULL, \"COL 317\" = NULL, \"COL 318\" = NULL, \"COL 319\" = NULL, \"COL 320\" = NULL, \"COL 321\" = NULL, \"COL 323\" = NULL, \"COL 324\" = NULL, \"COL 325\" = HEXTORAW('46'), \"COL 326\" = NULL, \"COL 328\" = NULL, \"COL 329\" = NULL, \"COL 330\" = NULL, \"COL 331\" = NULL, \"COL 332\" = NULL, \"COL 335\" = NULL, \"COL 336\" = NULL, \"COL 338\" = NULL, \"COL 339\" = NULL, \"COL 340\" = NULL, \"COL 341\" = NULL, \"COL 342\" = NULL, \"COL 343\" = NULL, \"COL 344\" = NULL, \"COL 345\" = NULL, \"COL 346\" = NULL, \"COL 347\" = NULL, \"COL 348\" = NULL, \"COL 349\" = NULL, \"COL 350\" = NULL, \"COL 355\" = NULL, \"COL 356\" = NULL, \"COL 357\" = NULL, \"COL 358\" = NULL, \"COL 359\" = NULL, \"COL 360\" = NULL, \"COL 361\" = HEXTORAW('4e') where \"COL 1\" = HEXTORAW('c4154b0957') and \"COL 2\" = HEXTORAW('c154') and \"COL 3\" = HEXTORAW('c40d170e5c') and \"COL 4\" = HEXTORAW('c20b02') and \"COL 5\" = HEXTORAW('c102') and \"COL 6\" = HEXTORAW('31343538383139') and \"COL 7\" = HEXTORAW('787c081b010101') and \"COL 8\" = HEXTORAW('787c081b010101') and \"COL 9\" IS NULL and \"COL 10\" = HEXTORAW('4541') and \"COL 11\" = HEXTORAW('c155') and \"COL 12\" = HEXTORAW('4541') and \"COL 13\" = HEXTORAW('80') and \"COL 14\" IS NULL and \"COL 15\" = HEXTORAW('c155') and \"COL 16\" IS NULL and \"COL 17\" IS NULL and \"COL 18\" IS NULL and \"COL 19\" IS NULL and \"COL 20\" = HEXTORAW('53') and \"COL 21\" IS NULL and \"COL 22\" IS NULL and \"COL 23\" = HEXTORAW('c2033e') and \"COL 24\" = HEXTORAW('c24504') and \"COL 25\" = HEXTORAW('c24105",
				"') and \"COL 26\" IS NULL and \"COL 27\" IS NULL and \"COL 28\" IS NULL and \"COL 29\" IS NULL and \"COL 30\" IS NULL and \"COL 31\" IS NULL and \"COL 32\" = HEXTORAW('c154') and \"COL 33\" = HEXTORAW('c3072a1a') and \"COL 34\" = HEXTORAW('38313230363734393734') and \"COL 35\" = HEXTORAW('80') and \"COL 36\" = HEXTORAW('80') and \"COL 37\" IS NULL and \"COL 38\" IS NULL and \"COL 39\" IS NULL and \"COL 40\" IS NULL and \"COL 41\" IS NULL and \"COL 42\" IS NULL and \"COL 43\" IS NULL and \"COL 44\" IS NULL and \"COL 45\" IS NULL and \"COL 46\" = HEXTORAW('c4020e5355') and \"COL 47\" = HEXTORAW('787c081b010101') and \"COL 48\" IS NULL and \"COL 49\" IS NULL and \"COL 50\" IS NULL and \"COL 51\" IS NULL and \"COL 52\" = HEXTORAW('c23d06') and \"COL 53\" = HEXTORAW('787c0814011f22') and \"COL 54\" = HEXTORAW('c102') and \"COL 55\" IS NULL and \"COL 56\" IS NULL and \"COL 57\" = HEXTORAW('3030303030315f554e53504543494649455f4c5f5354414e44415244') and \"COL 58\" = HEXTORAW('554e535045434946494544') and \"COL 59\" = HEXTORAW('50616964') and \"COL 60\" = HEXTORAW('435553544f4d45522053495445') and \"COL 61\" IS NULL and \"COL 62\" = HEXTORAW('c3022c02') and \"COL 63\" = HEXTORAW('3e6366') and \"COL 64\" IS NULL and \"COL 65\" IS NULL and \"COL 66\" = HEXTORAW('38313230363734393734') and \"COL 67\" IS NULL and \"COL 68\" = HEXTORAW('31') and \"COL 69\" IS NULL and \"COL 70\" IS NULL and \"COL 71\" IS NULL and \"COL 72\" IS NULL and \"COL 73\" IS NULL and \"COL 74\" IS NULL and \"COL 75\" IS NULL and \"COL 76\" IS NULL and \"COL 77\" IS NULL and \"COL 78\" IS NULL and \"COL 79\" IS NULL and \"COL 80\" IS NULL and \"COL 81\" IS NULL and \"COL 82\" IS NULL and \"COL 83\" IS NULL and \"COL 84\" IS NULL and \"COL 85\" IS NULL and \"COL 86\" IS NULL and \"COL 87\" IS NULL and \"COL 88\" IS NULL and \"COL 89\" IS NULL and \"COL 90\" IS NULL and \"COL 91\" IS NULL and \"COL 92\" IS NULL and \"COL 93\" IS NULL and \"COL 94\" IS NULL and \"COL 95\" IS NULL and \"COL 96\" IS NULL and \"COL 97\" IS NULL and \"COL 98\" IS NULL and \"COL 99\" IS NULL and \"COL 100\" IS NULL and \"COL 101\" IS NULL and \"COL 102\" IS NULL and \"COL 103\" IS NULL and \"COL 104\" IS NULL and \"COL 105\" IS NULL and \"COL 106\" IS NULL and \"COL 107\" IS NULL and \"COL 108\" IS NULL and \"COL 109\" IS NULL and \"COL 110\" IS NULL and \"COL 111\" IS NULL and \"COL 112\" IS NULL and \"COL 113\" IS NULL and \"COL 114\" IS NULL and \"COL 115\" IS NULL and \"COL 116\" IS NULL and \"COL 117\" IS NULL and \"COL 118\" IS NULL and \"COL 119\" IS NULL and \"COL 120\" IS NULL and \"COL 121\" IS NULL and \"COL 122\" IS NULL and \"COL 123\" IS NULL and \"COL 124\" IS NULL and \"COL 125\" IS NULL and \"COL 126\" IS NULL and \"COL 127\" IS NULL and \"COL 128\" IS NULL and \"COL 129\" IS NULL and \"COL 130\" IS NULL and \"COL 131\" IS NULL and \"COL 132\" IS NULL and \"COL 133\" IS NULL and \"COL 134\" IS NULL and \"COL 135\" IS NULL and \"COL 136\" IS NULL and \"COL 137\" IS NULL and \"COL 138\" IS NULL and \"COL 139\" IS NULL and \"COL 140\" IS NULL and \"COL 141\" IS NULL and \"COL 142\" IS NULL and \"COL 143\" IS NULL and \"COL 144\" IS NULL and \"COL 145\" IS NULL and \"COL 146\" IS NULL and \"COL 147\" IS NULL and \"COL 148\" IS NULL and \"COL 149\" IS NULL and \"COL 150\" IS NULL and \"COL 151\" IS NULL and \"COL 152\" IS NULL and \"COL 153\" IS NULL and \"COL 154\" IS NULL and \"COL 155\" IS NULL and \"COL 156\" = HEXTORAW('787c0814011f23') and \"COL 157\" = HEXTORAW('80') and \"COL 158\" = HEXTORAW('787c0814011f23') and \"COL 159\" = HEXTORAW('80') and \"COL 160\" = HEXTORAW('c5021f1d551c') and \"COL 161\" = HEXTORAW('c2073d') and \"COL 162\" = HEXTORAW('c3045f2b') and \"COL 163\" = HEXTORAW('787c0814011f1d') and \"COL 164\" = HEXTORAW('c5021d1e054c') and \"COL 165\" IS NULL and \"COL 166\" IS NULL and \"COL 167\" IS NULL and \"COL 168\" IS NULL and \"COL 169\" IS NULL and \"COL 170\" IS NULL and \"COL 171\" = HEXTORAW('5354414e44415244') and \"COL 172\" IS NULL and \"COL 173\" = HEXTORAW('4e') and \"COL 174\" = HEXTORAW('4e') and \"COL 175\" IS NULL and \"COL 176\" = HEXTORAW('4f52444552') and \"COL 177\" IS NULL and \"COL 178\" IS NULL and \"COL 179\" IS NULL and \"COL 180\" IS NULL and \"COL 181\" IS NULL and \"COL 182\" IS NULL and \"COL 183\" IS NULL and \"COL 184\" IS NULL and \"COL 1",
				"85\" IS NULL and \"COL 186\" IS NULL and \"COL 187\" IS NULL and \"COL 188\" IS NULL and \"COL 189\" IS NULL and \"COL 190\" IS NULL and \"COL 191\" IS NULL and \"COL 192\" IS NULL and \"COL 193\" IS NULL and \"COL 194\" IS NULL and \"COL 195\" IS NULL and \"COL 196\" IS NULL and \"COL 197\" IS NULL and \"COL 198\" IS NULL and \"COL 199\" IS NULL and \"COL 200\" IS NULL and \"COL 201\" = HEXTORAW('787d081b010101') and \"COL 202\" IS NULL and \"COL 203\" IS NULL and \"COL 204\" IS NULL and \"COL 205\" IS NULL and \"COL 206\" = HEXTORAW('494e5445524e414c') and \"COL 207\" = HEXTORAW('4e') and \"COL 208\" = HEXTORAW('59') and \"COL 209\" = HEXTORAW('4e') and \"COL 210\" = HEXTORAW('3e6266') and \"COL 211\" IS NULL and \"COL 212\" IS NULL and \"COL 213\" IS NULL and \"COL 214\" IS NULL and \"COL 215\" IS NULL and \"COL 216\" IS NULL and \"COL 217\" IS NULL and \"COL 218\" IS NULL and \"COL 219\" = HEXTORAW('c3280e23') and \"COL 220\" = HEXTORAW('43555354') and \"COL 221\" IS NULL and \"COL 222\" IS NULL and \"COL 223\" = HEXTORAW('4e') and \"COL 224\" IS NULL and \"COL 225\" IS NULL and \"COL 226\" IS NULL and \"COL 227\" IS NULL and \"COL 228\" IS NULL and \"COL 229\" IS NULL and \"COL 230\" = HEXTORAW('c107') and \"COL 231\" = HEXTORAW('323032343038323020303033303037202b2e31') and \"COL 232\" IS NULL and \"COL 233\" IS NULL and \"COL 234\" = HEXTORAW('31') and \"COL 235\" IS NULL and \"COL 236\" = HEXTORAW('c057') and \"COL 237\" IS NULL and \"COL 238\" IS NULL and \"COL 239\" IS NULL and \"COL 240\" IS NULL and \"COL 241\" IS NULL and \"COL 242\" IS NULL and \"COL 243\" IS NULL and \"COL 244\" IS NULL and \"COL 245\" IS NULL and \"COL 246\" IS NULL and \"COL 247\" IS NULL and \"COL 248\" IS NULL and \"COL 249\" IS NULL and \"COL 250\" IS NULL and \"COL 251\" IS NULL and \"COL 252\" IS NULL and \"COL 253\" IS NULL and \"COL 254\" IS NULL and \"COL 255\" IS NULL and \"COL 256\" IS NULL and \"COL 257\" IS NULL and \"COL 258\" IS NULL and \"COL 259\" IS NULL and \"COL 260\" = HEXTORAW('59') and \"COL 261\" IS NULL and \"COL 262\" = HEXTORAW('4e') and \"COL 263\" = HEXTORAW('454e5445524544') and \"COL 264\" IS NULL and \"COL 265\" IS NULL and \"COL 266\" IS NULL and \"COL 267\" IS NULL and \"COL 268\" IS NULL and \"COL 269\" IS NULL and \"COL 270\" IS NULL and \"COL 271\" IS NULL and \"COL 272\" IS NULL and \"COL 273\" IS NULL and \"COL 274\" IS NULL and \"COL 275\" IS NULL and \"COL 276\" IS NULL and \"COL 277\" IS NULL and \"COL 278\" IS NULL and \"COL 279\" IS NULL and \"COL 280\" IS NULL and \"COL 281\" IS NULL and \"COL 282\" IS NULL and \"COL 283\" IS NULL and \"COL 284\" IS NULL and \"COL 285\" = HEXTORAW('59') and \"COL 286\" IS NULL and \"COL 287\" IS NULL and \"COL 288\" IS NULL and \"COL 289\" IS NULL and \"COL 290\" IS NULL and \"COL 291\" IS NULL and \"COL 292\" IS NULL and \"COL 293\" IS NULL and \"COL 294\" IS NULL and \"COL 295\" IS NULL and \"COL 296\" IS NULL and \"COL 297\" IS NULL and \"COL 298\" = HEXTORAW('c102') and \"COL 299\" IS NULL and \"COL 300\" IS NULL and \"COL 301\" IS NULL and \"COL 302\" IS NULL and \"COL 303\" IS NULL and \"COL 304\" IS NULL and \"COL 305\" IS NULL and \"COL 306\" IS NULL and \"COL 307\" IS NULL and \"COL 308\" IS NULL and \"COL 309\" IS NULL and \"COL 310\" IS NULL and \"COL 311\" IS NULL and \"COL 312\" IS NULL and \"COL 313\" IS NULL and \"COL 314\" IS NULL and \"COL 315\" IS NULL and \"COL 316\" IS NULL and \"COL 317\" IS NULL and \"COL 318\" IS NULL and \"COL 319\" IS NULL and \"COL 320\" IS NULL and \"COL 321\" IS NULL and \"COL 322\" IS NULL and \"COL 323\" IS NULL and \"COL 324\" IS NULL and \"COL 325\" = HEXTORAW('46') and \"COL 326\" IS NULL and \"COL 327\" IS NULL and \"COL 328\" IS NULL and \"COL 329\" IS NULL and \"COL 330\" IS NULL and \"COL 331\" IS NULL and \"COL 332\" IS NULL and \"COL 335\" IS NULL and \"COL 336\" IS NULL and \"COL 337\" IS NULL and \"COL 338\" IS NULL and \"COL 339\" IS NULL and \"COL 340\" IS NULL and \"COL 341\" IS NULL and \"COL 342\" IS NULL and \"COL 343\" IS NULL and \"COL 344\" IS NULL and \"COL 345\" IS NULL and \"COL 346\" IS NULL and \"COL 347\" IS NULL and \"COL 348\" IS NULL and \"COL 349\" IS NULL and \"COL 350\" IS NULL and \"COL 351\" IS NULL and \"COL 352\" IS NULL and \"COL 353\" IS NULL and \"COL 354\" IS NULL and \"COL 355\" IS NULL and \"COL 356\" IS NULL and",
				" \"COL 357\" IS NULL and \"COL 358\" IS NULL and \"COL 359\" IS NULL and \"COL 360\" IS NULL and \"COL 361\" = HEXTORAW('4e') and \"COL 362\" IS NULL"
		};
		final StringBuilder sbUpdate = new StringBuilder(16000);
		int updSize = 0;
		for (final String s : sqlRedoUpdateArray) {
			updSize += s.length();
			sbUpdate.append(s);
		}
		final byte[] baUpdate = new byte[updSize];
		int pos = 0;
		for (final String s : sqlRedoUpdateArray) {
			System.arraycopy(s.getBytes(StandardCharsets.US_ASCII), 0, baUpdate, pos, s.length());
			pos += s.length();
		}
		assertEquals(
				new String(squeeze(baUpdate, baPattern, (byte)0x29), StandardCharsets.US_ASCII),
				sbUpdate.toString().replace(pattern, "").replace("')", "'")
		);

		System.out.println();
		System.out.println(new String(squeeze(baUpdate, baPattern, (byte)0x29), StandardCharsets.US_ASCII));
		System.out.println(sbUpdate.toString().replace(pattern, "").replace("')", "'"));

	}

	private static byte[] squeeze(final byte[] array, final byte[] patternBegin, final byte patternEnd) {
		int start = 0;
		int srcPos = 0;
		int destPos = 0;
		int currLength = 0;
		byte[] squeezedArray = new byte[array.length];
		while ((srcPos = BinaryUtils.indexOf(array, start, patternBegin)) > -1) {
			currLength = srcPos - start;
			System.arraycopy(array, start, squeezedArray, destPos, currLength);
			start = srcPos + patternBegin.length;
			destPos += currLength;

			if ((srcPos = BinaryUtils.indexOf(array, start, patternEnd)) > -1) {
				currLength = srcPos - start;
				System.arraycopy(array, start, squeezedArray, destPos, currLength);
				start = srcPos + 1;
				destPos += currLength;
			}
		}
		if (start < array.length) {
			currLength = array.length - start;
			System.arraycopy(array, start, squeezedArray, destPos, currLength);
			destPos += currLength;
		}

		if (destPos < squeezedArray.length) {
			final byte[] result = new byte[destPos];
			System.arraycopy(squeezedArray, 0, result, 0, destPos);
			squeezedArray = null;
			return result;
		} else {
			return squeezedArray;
		}
	}

}
